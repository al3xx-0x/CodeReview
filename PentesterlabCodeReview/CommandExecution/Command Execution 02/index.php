<?php
if (!isset($_GET["ip"])) {
    header("Location: /?ip=127.0.0.1");
    die();
}

if (preg_match('/;/', $_GET['ip']) ||
    preg_match('/&/', $_GET['ip']) ||
    preg_match('/\|/', $_GET['ip'])) {
    die("Invalid IP address");
}

require "header.php";
?>

<div class="row">
    <div class="col-lg-12">
        <h1>Command Execution 02</h1>
        <pre>
$ ping -c 2 <?php echo $_GET['ip']; ?>
<?php
system("ping -c 2 " . $_GET['ip']);
?>
        </pre>

        <p>The objective of this exercise is to find the Command Execution vulnerability in this page.</p>
    </div>
</div>

<?php
require "footer.php";
?>
