<?php
if (!isset($_GET["url"])) {
    header("Location: /?url=https://assets.pentesterlab.com/hacker.txt");
    die();
}
require "header.php";
?>

<div class="row">
    <div class="col-lg-12">
        <h1>Server Side Request Forgery 01</h1>

        <p>
            Welcome
            <?php
            if (isset($_GET['url'])) {
                echo htmlentities(file_get_contents($_GET['url'])) . "!";
            } else {
                echo "!";
            }
            ?>
        </p>

        <p>
            The objective of this exercise is to find the SSRF in this page.
            Once you find it you need to retrieve the key located at the root
            of the webserver listening on localhost on port TCP/1234.
        </p>
    </div>
</div>
