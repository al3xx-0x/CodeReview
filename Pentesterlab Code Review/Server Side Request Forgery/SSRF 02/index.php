<?php
if (!isset($_GET["url"])) {
    header("Location: /?url=https://assets.pentesterlab.com/hacker.txt");
    die();
}
require "header.php";
?>

<div class="row">
    <div class="col-lg-12">
        <h1>Server Side Request Forgery 02</h1>

        <p>
            Welcome
            <?php
            $url = $_GET['url'];

            if (
                isset($url)
                && (strpos(parse_url($url, PHP_URL_SCHEME), 'http') === 0)
                && (parse_url($url, PHP_URL_HOST) != '127.0.0.1')
            ) {
                echo htmlentities(file_get_contents($_GET['url'])) . "!";
            } else {
                echo "Invalid URL!";
            }
            ?>
        </p>
    </div>
</div>
