<?php
if (!isset($_GET["url"])) {
    header("Location: /?url=https://assets.pentesterlab.com/hacker.txt");
    die();
}

require "header.php";
?>

<div class="row">
    <div class="col-lg-12">
        <h1>Server Side Request Forgery 04</h1>
        <p>Welcome
        <?php
        $url = $_GET['url'];
        if (
            isset($url)
            and (strpos(parse_url($url, PHP_URL_SCHEME), 'http') === 0)
            and (preg_match("/assets.pentesterlab.com/", parse_url($url, PHP_URL_HOST)))
        ) {
            echo htmlentities(file_get_contents($_GET['url'])) . "!";
        } else {
            echo "Invalid URL!";
        }
        ?>
        </p>
    </div>
</div>
