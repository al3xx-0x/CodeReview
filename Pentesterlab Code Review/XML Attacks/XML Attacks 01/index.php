<?php

if (!isset($_GET["xml"])) {
    header("Location: /?xml=<test>hacker</test>");
    die();
}

libxml_disable_entity_loader(false);

$xml = simplexml_load_string(
    $_GET['xml'],
    'SimpleXMLElement',
    LIBXML_NOENT
);

require "header.php";
?>

<div class="row">
    <div class="col-lg-12">
        <h1>XML 01</h1>
        <p>
            The objective of this exercise is to find the XML vulnerability in this page
            and use it to retrieve the key in the following file:
            <code>/pentesterlab.key</code>
        </p>
        <h3>Hello <?php echo (string)$xml ?></h3>
    </div>
</div>
